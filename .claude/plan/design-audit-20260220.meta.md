# Design Integrity Audit — Meta Plan
**生成日**: 2026-02-20
**プロジェクト**: record-app v2.0.0-beta.13

## 1. 設計思想概要（核心原則）
- E1-E5 UX体験保護（各体験を独立評価）
- 3層アーキテクチャ（API Routes薄→Service→Prisma）
- Supabase Auth JWT + RLS + DEV_AUTH_BYPASS本番禁止
- 分人視覚署名（色+アイコン+形の3点固定、クロスクライアント一貫性）
- 暗号化（AES-256-GCM + SQLCipher）+ 音声即削除 + AudioDeletionLog
- イミュータブルデータ + Zodバリデーション + errorResponse()統一

## 2. 評価軸（ルーブリック、14項目）

| # | 評価項目 | 重み | 加重満点 |
|---|---------|------|----------|
| 1 | 3層アーキテクチャ遵守 | 0.15 | 15 |
| 2 | E1: 常に聴いている（FGS録音/オフラインキュー/STT） | 0.05 | 5 |
| 3 | E2: 分人別に整理される（RuleTree/PublishedVersion） | 0.04 | 4 |
| 4 | E3: 執事が一手を出す（Gemini提案/Memory活用） | 0.03 | 3 |
| 5 | E4: 軽く振り返る（WeeklyExecution） | 0.02 | 2 |
| 6 | E5: 執事が育つ（Memory append-only） | 0.01 | 1 |
| 7 | 認証・認可・セキュリティ境界 | 0.15 | 15 |
| 8 | データ整合性・状態遷移 | 0.12 | 12 |
| 9 | イミュータビリティ・副作用制御 | 0.08 | 8 |
| 10 | 入力バリデーション・エラーハンドリング | 0.10 | 10 |
| 11 | 分人視覚署名の一貫性 | 0.05 | 5 |
| 12 | 暗号化・プライバシー・音声データ管理 | 0.08 | 8 |
| 13 | オフライン耐性・冪等性 | 0.07 | 7 |
| 14 | ファイル構成・コード品質 | 0.05 | 5 |
| **合計** | | **1.00** | **100** |

## 3. 実行プラン
- Phase 3: チーム編成（Layer A×5 / Layer B×3 / Layer C×1）
- Phase 4: deep-researcherで並列調査
- Phase 5: architectによるレビュー
- Phase 6: Orchestratorが実施順序決定
- Phase 7: リファクタリング実行
- Phase 8: スコア採点（97未満→Phase 3に戻る、最大3回）
- Phase 9: 認定・Issue化・コミット推奨

**合格基準**: 97/100
**最大再帰**: 3回
**停止条件**: 改善幅 < 2点が連続2ラウンド
